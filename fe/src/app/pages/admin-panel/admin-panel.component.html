<div class="admin-panel">
  <h1>Admin-Panel</h1>

  <div class="admin-sections">
    <div class="admin-card animal-management">
      <div class="card-header">
        <h2>Tierverwaltung</h2>
        <p-button
          label="Neues Tier hinzufügen"
          icon="pi pi-plus"
          (onClick)="openAddDialog()"
          styleClass="p-button-success">
        </p-button>
      </div>

      <p-table [value]="animals()" [paginator]="true" [rows]="10" styleClass="p-datatable-striped">
        <ng-template pTemplate="header">
          <tr>
            <th>Name</th>
            <th>Beschreibung</th>
            <th>Patenschaft verfügbar</th>
            <th>Aktueller Pate</th>
            <th>Aktionen</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-animal>
          <tr>
            <td>{{ animal.name }}</td>
            <td>{{ animal.teaser || animal.description }}</td>
            <td>
              <i
                [class]="
                  animal.sponsorshipAvailable
                    ? 'pi pi-check text-green-500'
                    : 'pi pi-times text-red-500'
                "></i>
            </td>
            <td>{{ animal.hasCurrentSponsorship ? animal.sponsorName || 'Ja' : 'Keine' }}</td>
            <td>
              <p-button
                icon="pi pi-pencil"
                (onClick)="openEditDialog(animal)"
                styleClass="p-button-text p-button-info mr-2"
                pTooltip="Bearbeiten">
              </p-button>
              <p-button
                icon="pi pi-trash"
                (onClick)="deleteAnimal(animal)"
                styleClass="p-button-text p-button-danger"
                pTooltip="Löschen">
              </p-button>
            </td>
          </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="5" class="text-center">Keine Tiere gefunden</td>
          </tr>
        </ng-template>
      </p-table>
    </div>

    <div class="admin-card">
      <h2>Benutzerverwaltung</h2>
      <p>Verwalten Sie Benutzerkonten und Berechtigungen.</p>
    </div>

    <div class="admin-card">
      <h2>Systemeinstellungen</h2>
      <p>Konfigurieren Sie Anwendungseinstellungen und Präferenzen.</p>
    </div>
  </div>
</div>

<p-dialog
  [header]="dialogTitle()"
  [visible]="showDialog()"
  (onHide)="hideDialog()"
  [modal]="true"
  [style]="{ width: '500px', overflow: 'hidden' }"
  [closable]="true">
  <div class="animal-form">
    <div class="field">
      <label for="name">Name *</label>
      <input
        id="name"
        type="text"
        pInputText
        [value]="animalForm().name"
        (input)="updateFormField('name', $any($event.target).value)"
        placeholder="Tiername"
        class="w-full" />
    </div>

    <div class="field">
      <label for="teaser">Teaser</label>
      <input
        id="teaser"
        type="text"
        pInputText
        [value]="animalForm().teaser"
        (input)="updateFormField('teaser', $any($event.target).value)"
        placeholder="Kurzer Teaser-Text"
        class="w-full" />
    </div>

    <div class="field">
      <label for="description">Beschreibung</label>
      <textarea
        id="description"
        [value]="animalForm().description"
        (input)="updateFormField('description', $any($event.target).value)"
        placeholder="Detaillierte Beschreibung"
        rows="4"
        class="w-full p-inputtext">
      </textarea>
    </div>

    <div class="field-checkbox">
      <p-checkbox
        inputId="sponsorshipAvailable"
        [binary]="true"
        [ngModel]="animalForm().sponsorshipAvailable"
        (onChange)="updateFormField('sponsorshipAvailable', $event.checked)">
      </p-checkbox>
      <label for="sponsorshipAvailable">Patenschaft verfügbar</label>
    </div>

    <div class="field-checkbox">
      <p-checkbox
        inputId="hasCurrentSponsorship"
        [binary]="true"
        [ngModel]="animalForm().hasCurrentSponsorship"
        (onChange)="updateFormField('hasCurrentSponsorship', $event.checked)">
      </p-checkbox>
      <label for="hasCurrentSponsorship">Hat aktuelle Patenschaft</label>
    </div>

    @if (animalForm().hasCurrentSponsorship) {
      <div class="field">
        <label for="sponsorName">Name des Paten</label>
        <input
          id="sponsorName"
          type="text"
          pInputText
          [value]="animalForm().sponsorName"
          (input)="updateFormField('sponsorName', $any($event.target).value)"
          placeholder="Name des Paten"
          class="w-full" />
      </div>

      <div class="field">
        <label for="sponsorCustomText">Individueller Paten-Text</label>
        <textarea
          id="sponsorCustomText"
          [value]="animalForm().sponsorCustomText"
          (input)="updateFormField('sponsorCustomText', $any($event.target).value)"
          placeholder="Individueller Text vom Paten"
          rows="3"
          class="w-full p-inputtext">
        </textarea>
      </div>
    }
  </div>

  <ng-template pTemplate="footer">
    <p-button
      label="Abbrechen"
      icon="pi pi-times"
      (onClick)="hideDialog()"
      styleClass="p-button-text">
    </p-button>
    <p-button
      label="Speichern"
      icon="pi pi-check"
      (onClick)="saveAnimal()"
      styleClass="p-button-success">
    </p-button>
  </ng-template>
</p-dialog>

<p-confirmDialog></p-confirmDialog>
